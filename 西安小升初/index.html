<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>è¥¿å®‰å°å‡åˆæ™ºèƒ½è¯„ä¼°ç³»ç»Ÿ 2025å¢å¼ºç‰ˆ</title>
    <!-- å¤–éƒ¨CSSå’Œå­—ä½“ -->
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- èŠå¤©çª—å£æ ·å¼ä¿®å¤ -->
    <style>
        /* ========== ä¿®å¤èŠå¤©çª—å£æ ·å¼ ========== */

        /* èŠå¤©çª—å£å¯è°ƒæ•´å¤§å° */
        .ai-chat-window {
            position: fixed;
            bottom: 90px;
            right: 20px;
            width: 400px;
            max-width: 90vw;
            height: 600px;
            max-height: 80vh;
            background: white;
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
            display: none;
            flex-direction: column;
            z-index: 1000;
            /* å…è®¸è°ƒæ•´å¤§å° */
            resize: both;
            overflow: hidden;
            min-width: 320px;
            min-height: 400px;
        }

        .ai-chat-window.active {
            display: flex;
        }

        /* èŠå¤©è¾“å…¥æ¡† - æ”¯æŒå¤šè¡Œè¾“å…¥ */
        .chat-input {
            flex: 1;
            padding: 12px 15px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            resize: vertical; /* å…è®¸å‚ç›´è°ƒæ•´å¤§å° */
            min-height: 42px;
            max-height: 120px;
            line-height: 1.5;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            overflow-y: auto; /* å†…å®¹è¶…å‡ºæ—¶æ˜¾ç¤ºæ»šåŠ¨æ¡ */
            word-wrap: break-word;
            white-space: pre-wrap; /* ä¿ç•™æ¢è¡Œå’Œç©ºæ ¼ */
        }

        .chat-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        /* è¾“å…¥æ¡†å®¹å™¨ */
        .chat-input-group {
            display: flex;
            gap: 10px;
            align-items: flex-end; /* æŒ‰é’®ä¸è¾“å…¥æ¡†åº•éƒ¨å¯¹é½ */
            padding: 12px 15px;
            border-top: 1px solid #e2e8f0;
            background: #f8fafc;
        }

        /* å‘é€æŒ‰é’® */
        .send-btn {
            flex-shrink: 0;
            width: 42px;
            height: 42px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .send-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .send-btn:active {
            transform: translateY(0);
        }

        /* èŠå¤©æ¶ˆæ¯å†…å®¹è‡ªåŠ¨æ¢è¡Œ */
        .message-content {
            background: #f0f9ff;
            padding: 12px 16px;
            border-radius: 12px;
            max-width: 80%;
            word-wrap: break-word;
            word-break: break-word;
            white-space: pre-wrap; /* ä¿ç•™æ¢è¡Œ */
            line-height: 1.6;
            overflow-wrap: break-word;
        }

        .ai-message.user .message-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            margin-left: auto;
        }

        /* èŠå¤©çª—å£ä¸»ä½“è‡ªåŠ¨æ»šåŠ¨ */
        .ai-chat-body {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
            background: #ffffff;
        }

        /* å¿«æ·æ“ä½œæŒ‰é’® */
        .quick-actions {
            display: flex;
            gap: 8px;
            padding: 0 15px 12px 15px;
            flex-wrap: wrap;
            background: #f8fafc;
        }

        .quick-action-btn {
            padding: 6px 12px;
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 16px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s ease;
            white-space: nowrap;
        }

        .quick-action-btn:hover {
            background: #f0f9ff;
            border-color: #3b82f6;
            color: #3b82f6;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .ai-chat-window {
                width: 100%;
                height: 100%;
                max-width: 100%;
                max-height: 100%;
                bottom: 0;
                right: 0;
                border-radius: 0;
                resize: none; /* ç§»åŠ¨ç«¯ç¦ç”¨è°ƒæ•´å¤§å° */
            }
            
            .chat-input {
                font-size: 16px; /* é˜²æ­¢iOSè‡ªåŠ¨ç¼©æ”¾ */
            }
        }

        /* æ»šåŠ¨æ¡ç¾åŒ– */
        .ai-chat-body::-webkit-scrollbar {
            width: 6px;
        }

        .ai-chat-body::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        .ai-chat-body::-webkit-scrollbar-thumb {
            background: #cbd5e0;
            border-radius: 10px;
        }

        .ai-chat-body::-webkit-scrollbar-thumb:hover {
            background: #a0aec0;
        }

        .chat-input::-webkit-scrollbar {
            width: 4px;
        }

        .chat-input::-webkit-scrollbar-thumb {
            background: #cbd5e0;
            border-radius: 10px;
        }

        /* ========== ä¿®å¤èŠå¤©çª—å£æ‹–åŠ¨åŠŸèƒ½ ========== */
        .ai-chat-header {
            cursor: move;
            user-select: none;
            padding: 15px;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            gap: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 16px 16px 0 0;
        }

        .ai-chat-header:hover {
            background: linear-gradient(135deg, #5a67d8 0%, #6c3a9e 100%);
        }

        /* æ‹–åŠ¨çŠ¶æ€ */
        .ai-chat-window.dragging {
            opacity: 0.9;
            pointer-events: none;
        }

        /* å…³é—­æŒ‰é’® */
        .chat-close-btn {
            margin-left: auto;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s ease;
        }

        .chat-close-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* æ¶ˆæ¯æ ·å¼ä¼˜åŒ– */
        .ai-message {
            margin: 12px 0;
            display: flex;
            gap: 10px;
            align-items: flex-start;
        }

        .ai-message.assistant {
            flex-direction: row;
        }

        .ai-message.user {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            flex-shrink: 0;
        }

        .ai-message.assistant .message-avatar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .ai-message.user .message-avatar {
            background: #e2e8f0;
            color: #4a5568;
        }

        /* åŠ è½½åŠ¨ç”» */
        .ai-loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
        }

        .ai-loading-spinner {
            width: 30px;
            height: 30px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
    <!-- Chart.js for data visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- PDFå¯¼å‡ºåº“ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- Local Data -->
    <script src="data/faq.js"></script>
    <script src="data/schools.js"></script>
    <script src="data/citations.js"></script>
    <script src="data/policy.js"></script>
</head>
<body>
    <!-- APIçŠ¶æ€æŒ‡ç¤ºå™¨ -->
    <div class="api-status local" id="apiStatus" onclick="toggleConfigPanel()">
        <i class="fas fa-laptop"></i> <span id="statusText">æœ¬åœ°æ¨¡å¼</span>
    </div>
    
    <!-- APIé…ç½®é¢æ¿ -->
    <div class="config-panel" id="configPanel">
        <div class="config-title"><i class="fas fa-key"></i> æ¨¡å‹ä¸APIé…ç½®</div>
        <div class="config-status info" id="configStatus">é…ç½®åå°†å¯ç”¨ AI å¢å¼ºæ¨¡å¼ï¼ˆè¯·æ±‚ç»æœ¬ç«™åç«¯ç»Ÿä¸€è½¬å‘ï¼‰</div>
        <input type="password" class="config-input" id="apiKeyInput" placeholder="API Key (sk-å¼€å¤´æˆ–æ§åˆ¶å°ç”Ÿæˆ)">
        <input type="text" class="config-input" id="appIdInput" placeholder="APP IDï¼ˆä»…ç™¾ç‚¼éœ€è¦ï¼‰">
        <select class="config-input" id="providerSelect">
            <option value="bailian">é˜¿é‡Œç™¾ç‚¼/é€šä¹‰</option>
            <option value="google">Google Gemini</option>
            <option value="openai">OpenAI</option>
            <option value="deepseek">DeepSeek</option>
        </select>
        <button class="config-btn" onclick="saveAndTestConfig()"><i class="fas fa-plug"></i> ä¿å­˜å¹¶æµ‹è¯•</button>
        <button class="config-btn secondary" onclick="useLocalMode()"><i class="fas fa-laptop"></i> ä½¿ç”¨æœ¬åœ°æ¨¡å¼</button>
        <div class="config-help" id="providerHelp">
            <strong>é€šç”¨è¯´æ˜ï¼š</strong><br>
            - å‰ç«¯ä»…è®¿é—®æœ¬ç«™ <code>/api/ai</code>ï¼Œç”±åç«¯è½¬å‘åˆ°æ‰€é€‰æ¨¡å‹æä¾›å•†ï¼Œé¿å…è·¨åŸŸä¸åœ°åŸŸé™åˆ¶ã€‚<br>
            - è¯·åœ¨éƒ¨ç½²å¹³å°çš„ç¯å¢ƒå˜é‡ä¸­é…ç½®å¯†é’¥ï¼Œå‰ç«¯ä¸ä¿å­˜å¯†é’¥ã€‚<br>
            - å¦‚éœ€ç§»åŠ¨ç«¯å…¨å›½å¯ç”¨ï¼šå»ºè®®ä½¿ç”¨å›½å†…èŠ‚ç‚¹éƒ¨ç½²åç«¯å¹¶å¼€å¯ HTTPS/CDNï¼›é¿å…ç›´è¿å¢ƒå¤–æ¨¡å‹ã€‚<br>
            <br>
            <strong>é˜¿é‡Œç™¾ç‚¼/é€šä¹‰ï¼š</strong><br>
            - éœ€è®¾ç½®ç¯å¢ƒå˜é‡ï¼š<code>BAILIAN_API_KEY</code>ã€<code>BAILIAN_APP_ID</code><br>
            - æ§åˆ¶å°ï¼š<a href="https://bailian.console.aliyun.com" target="_blank">é˜¿é‡Œäº‘ç™¾ç‚¼æ§åˆ¶å°</a><br>
            <br>
            <strong>Google Geminiï¼š</strong><br>
            - éœ€è®¾ç½®ç¯å¢ƒå˜é‡ï¼š<code>GOOGLE_API_KEY</code><br>
            - å»ºè®®é€šè¿‡æœ¬ç«™åç«¯è½¬å‘ä»¥è·å¾—æœ€ä½³ä½“éªŒã€‚<br>
            <br>
            <strong>OpenAIï¼š</strong><br>
            - éœ€è®¾ç½®ï¼š<code>OPENAI_API_KEY</code>ï¼ˆå¯é€‰ <code>OPENAI_MODEL</code>ï¼Œé»˜è®¤ gpt-4o-miniï¼‰<br>
            - å»ºè®®é€šè¿‡æœ¬ç«™åç«¯è½¬å‘ï¼Œå®¢æˆ·ç«¯ä¸ç›´è¿ï¼Œé¿å…è¢«ç§»åŠ¨ç½‘ç»œ/åœ°åŸŸç­–ç•¥å½±å“ã€‚<br>
            <br>
            <strong>DeepSeekï¼š</strong><br>
            - éœ€è®¾ç½®ï¼š<code>DEEPSEEK_API_KEY</code>ï¼ˆå¯é€‰ <code>DEEPSEEK_MODEL</code>ï¼Œé»˜è®¤ deepseek-chatï¼‰<br>
            - è®¿é—®é¢‘ç¹æ—¶å»ºè®®å¼€å¯åç«¯ Keep-Alive ä¸é‡è¯•ç­–ç•¥ã€‚<br>
        </div>
    </div>

    <div class="container">
        <div class="progress-bar" id="progressBar"></div>
        
        <h1>ğŸ“ è¥¿å®‰å°å‡åˆæ™ºèƒ½è¯„ä¼°ç³»ç»Ÿ <span class="ai-badge">2025å¢å¼ºç‰ˆ</span></h1>
        <p class="subtitle">åŸºäºæƒå¨çŸ¥è¯† Â· å®æ—¶æ›´æ–° Â· å¤šé‡éªŒè¯ Â· æ·±åº¦ä¸ªæ€§åŒ–</p>
        
        <!-- PDFå¯¼å‡ºæŒ‰é’® -->
        <div style="margin: 20px 0; text-align: center;">
            <button id="exportFullPdfBtn" class="btn btn-primary" style="margin: 10px;">
                <i class="fas fa-file-pdf"></i> ğŸ“„ å¯¼å‡ºå®Œæ•´ç‰ˆå‡å­¦æŠ¥å‘Š PDF
            </button>
        </div>
        
        <!-- AIåŠ©æ‰‹ -->
        <div class="ai-assistant">
            <button class="ai-assistant-btn" onclick="toggleChat()">ğŸ±</button>
            <div class="ai-chat-window" id="chatWindow">
                <div class="ai-chat-header" id="chatHeader">
                    <div style="font-size: 32px;">ğŸ±</div>
                    <div>
                        <div style="font-weight: 600;">å°å–µå‡å­¦åŠ©æ‰‹</div>
                        <div style="font-size: 12px; opacity: 0.8;" id="chatApiStatus">æœ¬åœ°æ¨¡å¼</div>
                    </div>
                </div>
                <div class="ai-chat-body" id="chatBody">
                    <div class="ai-message assistant">
                        <div class="message-avatar">ğŸ±</div>
                        <div class="message-content">
                            å–µ~æ‚¨å¥½ï¼æˆ‘æ˜¯åŸºäº2025å¹´è¥¿å®‰ä¹‰åŠ¡æ•™è‚²æ”¿ç­–çš„å‡å­¦åŠ©æ‰‹ï¼
                            <br>ğŸ“‹ æ”¿ç­–ï¼šå…¬æ°‘åŒæ‹›ã€å…è¯•å…¥å­¦
                            <br>ğŸ« æ°‘åŠï¼š28æ‰€å­¦æ ¡ï¼Œè®¡åˆ’æ‹›ç”Ÿ12361äºº
                            <br>ğŸ“… æŠ¥åï¼š7æœˆ11æ—¥-24æ—¥
                            <br>ğŸ² æ‘‡å·ï¼š7æœˆ30æ—¥
                            <br>æœ‰ä»€ä¹ˆå¯ä»¥å¸®æ‚¨çš„ï¼Ÿ
                            <div class="source-info">
                                <span class="trust-badge trust-official">å®˜æ–¹æ•°æ®</span>
                                ä¿¡æ¯æ¥æºï¼šè¥¿å®‰å¸‚æ•™è‚²å±€ 2025å¹´æ‹›ç”Ÿæ”¿ç­–
                                <div class="timestamp">æ›´æ–°æ—¶é—´ï¼š2025-01-15</div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- æ›¿æ¢ä¸ºä¿®å¤åçš„èŠå¤©è¾“å…¥éƒ¨åˆ† -->
                <div class="ai-chat-input">
                    <div class="chat-input-group">
                        <!-- å°†inputæ”¹ä¸ºtextareaæ”¯æŒå¤šè¡Œè¾“å…¥ -->
                        <textarea 
                            class="chat-input" 
                            id="chatInput" 
                            placeholder="è¾“å…¥é—®é¢˜...&#10;Shift+Enteræ¢è¡Œ,Enterå‘é€"
                            rows="1"
                            onkeydown="handleChatKeyPress(event)"
                        ></textarea>
                        <button class="send-btn" id="sendBtn" onclick="sendMessage()">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                    <div class="quick-actions">
                        <button class="quick-action-btn" onclick="quickAction('2026å¹´å°å‡åˆæ—¶é—´å®‰æ’')">æ—¶é—´å®‰æ’</button>
                        <button class="quick-action-btn" onclick="quickAction('æ°‘åŠå­¦æ ¡æœ‰å“ªäº›')">æ°‘åŠå­¦æ ¡</button>
                        <button class="quick-action-btn" onclick="quickAction('æ‘‡å·æ”¿ç­–')">æ‘‡å·æ”¿ç­–</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- é‡è¦é€šçŸ¥ -->
        <div class="important-notice">
            <h3>ğŸ“‹ 2025å¹´è¥¿å®‰ä¹‰åŠ¡æ•™è‚²æ‹›ç”Ÿæ”¿ç­–è¦ç‚¹</h3>
            <ul>
                <li><strong>å…è¯•å°±è¿‘å…¥å­¦ï¼š</strong>å…¬åŠå­¦æ ¡æŒ‰å­¦åŒºåˆ’ç‰‡æ‹›ç”Ÿï¼Œä¸¥ç¦è€ƒè¯•é€‰æ‹”</li>
                <li><strong>å…¬æ°‘åŒæ‹›ï¼š</strong>æ°‘åŠä¸å…¬åŠåŒæ­¥æŠ¥å(7æœˆ11-24æ—¥)ã€åŒæ­¥æ‹›ç”Ÿ</li>
                <li><strong>ç”µè„‘éšæœºå½•å–ï¼š</strong>æ°‘åŠæŠ¥åè¶…è®¡åˆ’çš„å®è¡Œæ‘‡å·ï¼Œ7æœˆ30æ—¥ç»Ÿä¸€è¿›è¡Œ</li>
                <li><strong>æ‹›ç”Ÿå¹³å°ï¼š</strong>ç»Ÿä¸€ä½¿ç”¨é™•è¥¿"æ•™è‚²å…¥å­¦ä¸€ä»¶äº‹"æ‹›ç”Ÿå¹³å°</li>
                <li><strong>æ°‘åŠè§„æ¨¡ï¼š</strong>å…¨å¸‚28æ‰€æ°‘åŠåˆä¸­ï¼Œè®¡åˆ’æ‹›ç”Ÿ12361äºº</li>
                <li><strong>è¥¿å’¸æ–°åŒºçº³å…¥åŸå…­åŒºæ‹›ç”Ÿï¼š</strong>è¥¿å’¸æ–°åŒºä¸åŸå…­åŒºæ‹›ç”Ÿæ”¿ç­–ç»Ÿä¸€</li>
            </ul>
            <div class="source-info" style="margin-top: 15px; color: rgba(255,255,255,0.8);">
                <span class="trust-badge trust-official">å®˜æ–¹å‘å¸ƒ</span>
                æ•°æ®æ¥æºï¼šè¥¿å®‰å¸‚æ•™è‚²å±€å®˜æ–¹ç½‘ç«™
                <div class="timestamp">æ”¿ç­–å‘å¸ƒæ—¥æœŸï¼š2025-01-10</div>
            </div>
        </div>

        <!-- æ­¥éª¤æŒ‡ç¤ºå™¨ - æ›´æ–°ä¸º7æ­¥ -->
        <div class="step-indicator">
            <div class="step active" id="step1-indicator" onclick="showStep(1)"><div class="step-number">1</div><div class="step-label">åŸºç¡€ä¿¡æ¯</div></div>
            <div class="step" id="step2-indicator" onclick="showStep(2)"><div class="step-number">2</div><div class="step-label">èƒ½åŠ›è¯„ä¼°</div></div>
            <div class="step" id="step3-indicator" onclick="showStep(3)"><div class="step-number">3</div><div class="step-label">æˆ·ç±ä¸å±…ä½</div></div>
            <div class="step" id="step4-indicator" onclick="showStep(4)"><div class="step-number">4</div><div class="step-label">å­¦åŒºæˆ¿äº§</div></div>
            <div class="step" id="step5-indicator" onclick="showStep(5)"><div class="step-number">5</div><div class="step-label">æ°‘åŠæ„å‘</div></div>
            <div class="step" id="step6-indicator" onclick="showStep(6)"><div class="step-number">6</div><div class="step-label">èƒ½åŠ›åˆ†æ</div></div>
            <div class="step" id="step7-indicator" onclick="showStep(7)"><div class="step-number">7</div><div class="step-label">AIæ¨è</div></div>
        </div>

        <!-- æ­¥éª¤1ï¼šåŸºç¡€ä¿¡æ¯ -->
        <div id="step1" class="section active">
            <!-- ä¿®æ­£åçš„å­¦ç”Ÿå¹´çº§ä¿¡æ¯ -->
            <div class="dimension-card">
                <div class="dimension-title">ğŸ“ å­¦ç”Ÿå½“å‰å¹´çº§</div>
                <div class="dimension-desc">é€‰æ‹©å­¦ç”Ÿå½“å‰æ‰€åœ¨å¹´çº§ï¼Œç”¨äºç²¾ç¡®çš„æ—¶é—´è§„åˆ’</div>
                <div class="score-options">
                    <div class="score-option">
                        <input type="radio" name="currentGrade" id="grade6" value="å…­å¹´çº§" checked>
                        <label for="grade6" class="score-label">
                            <span class="score-number">å…­å¹´çº§</span>
                            <span class="score-desc">2026å¹´å°å‡åˆ</span>
                        </label>
                    </div>
                    <div class="score-option">
                        <input type="radio" name="currentGrade" id="grade5" value="äº”å¹´çº§">
                        <label for="grade5" class="score-label">
                            <span class="score-number">äº”å¹´çº§</span>
                            <span class="score-desc">2027å¹´å°å‡åˆ</span>
                        </label>
                    </div>
                    <div class="score-option">
                        <input type="radio" name="currentGrade" id="grade4" value="å››å¹´çº§">
                        <label for="grade4" class="score-label">
                            <span class="score-number">å››å¹´çº§</span>
                            <span class="score-desc">2028å¹´å°å‡åˆ</span>
                        </label>
                    </div>
                </div>
            </div>

            <div class="dimension-card">
                <div class="dimension-title">ğŸ‘¦ å­¦ç”ŸåŸºæœ¬ä¿¡æ¯</div>
                <div class="dimension-desc">å¡«å†™å­¦ç”ŸåŸºæœ¬èµ„æ–™</div>
                <div class="info-group">
                    <label class="info-label">å­¦ç”Ÿå§“åï¼ˆå¯é€‰ï¼‰</label>
                    <input type="text" class="info-input" id="studentName" placeholder="è¯·è¾“å…¥å­¦ç”Ÿå§“å">
                </div>
                <div class="info-group">
                    <label class="info-label">å­¦ç”Ÿæ€§åˆ«</label>
                    <select class="info-select" id="studentGender">
                        <option value="">è¯·é€‰æ‹©</option>
                        <option value="ç”·">ç”·ç”Ÿ</option>
                        <option value="å¥³">å¥³ç”Ÿ</option>
                    </select>
                </div>
                <div class="info-group">
                    <label class="info-label">æ‰€åœ¨å°å­¦ï¼ˆå¯é€‰ï¼‰</label>
                    <input type="text" class="info-input" id="currentSchool" placeholder="è¯·è¾“å…¥æ‰€åœ¨å°å­¦åç§°">
                </div>
            </div>

            <div class="button-group">
                <button class="btn btn-primary" onclick="goToStep2()">ä¸‹ä¸€æ­¥ï¼šèƒ½åŠ›è¯„ä¼° â†’</button>
            </div>
        </div>

        <!-- æ­¥éª¤2ï¼šèƒ½åŠ›è¯„ä¼° -->
        <div id="step2" class="section">
            <div class="dimension-card">
                <div class="dimension-title">ğŸ“š ç»´åº¦ä¸€ï¼šå­¦ä¸šæˆç»©</div>
                <div class="dimension-desc">è¯„ä¼°å­©å­åœ¨ç­çº§/å¹´çº§çš„å­¦ä¸šæˆç»©æ’åæƒ…å†µ</div>
                <div class="score-options">
                    <div class="score-option"><input type="radio" name="score1" id="s1-5" value="5"><label for="s1-5" class="score-label"><span class="score-number">5</span><span class="score-desc">å¹´çº§å‰5%</span></label></div>
                    <div class="score-option"><input type="radio" name="score1" id="s1-4" value="4"><label for="s1-4" class="score-label"><span class="score-number">4</span><span class="score-desc">å¹´çº§å‰15%</span></label></div>
                    <div class="score-option"><input type="radio" name="score1" id="s1-3" value="3"><label for="s1-3" class="score-label"><span class="score-number">3</span><span class="score-desc">å¹´çº§å‰30%</span></label></div>
                    <div class="score-option"><input type="radio" name="score1" id="s1-2" value="2"><label for="s1-2" class="score-label"><span class="score-number">2</span><span class="score-desc">å¹´çº§å‰50%</span></label></div>
                    <div class="score-option"><input type="radio" name="score1" id="s1-1" value="1"><label for="s1-1" class="score-label"><span class="score-number">1</span><span class="score-desc">å¹´çº§50%å</span></label></div>
                </div>
            </div>
            
            <div class="dimension-card">
                <div class="dimension-title">ğŸ¨ ç»´åº¦äºŒï¼šç»¼åˆç´ å…»</div>
                <div class="dimension-desc">ç‰¹é•¿ã€è·å¥–æƒ…å†µå’Œç»¼åˆå‘å±•æ°´å¹³</div>
                <div class="score-options">
                    <div class="score-option"><input type="radio" name="score2" id="s2-5" value="5"><label for="s2-5" class="score-label"><span class="score-number">5</span><span class="score-desc">çœçº§è·å¥–</span></label></div>
                    <div class="score-option"><input type="radio" name="score2" id="s2-4" value="4"><label for="s2-4" class="score-label"><span class="score-number">4</span><span class="score-desc">å¸‚çº§è¯ä¹¦</span></label></div>
                    <div class="score-option"><input type="radio" name="score2" id="s2-3" value="3"><label for="s2-3" class="score-label"><span class="score-number">3</span><span class="score-desc">æ ¡çº§è·å¥–</span></label></div>
                    <div class="score-option"><input type="radio" name="score2" id="s2-2" value="2"><label for="s2-2" class="score-label"><span class="score-number">2</span><span class="score-desc">å‚ä¸æ´»åŠ¨</span></label></div>
                    <div class="score-option"><input type="radio" name="score2" id="s2-1" value="1"><label for="s2-1" class="score-label"><span class="score-number">1</span><span class="score-desc">è¾ƒå°‘å‚ä¸</span></label></div>
                </div>
            </div>

            <div class="dimension-card">
                <div class="dimension-title">ğŸ“– ç»´åº¦ä¸‰ï¼šå­¦ä¹ ä¹ æƒ¯</div>
                <div class="dimension-desc">è‡ªå¾‹æ€§å’Œå­¦ä¹ ä¸»åŠ¨æ€§</div>
                <div class="score-options">
                    <div class="score-option"><input type="radio" name="score3" id="s3-5" value="5"><label for="s3-5" class="score-label"><span class="score-number">5</span><span class="score-desc">éå¸¸è‡ªå¾‹</span></label></div>
                    <div class="score-option"><input type="radio" name="score3" id="s3-4" value="4"><label for="s3-4" class="score-label"><span class="score-number">4</span><span class="score-desc">è¾ƒä¸ºè‡ªå¾‹</span></label></div>
                    <div class="score-option"><input type="radio" name="score3" id="s3-3" value="3"><label for="s3-3" class="score-label"><span class="score-number">3</span><span class="score-desc">éœ€è¦ç›‘ç£</span></label></div>
                    <div class="score-option"><input type="radio" name="score3" id="s3-2" value="2"><label for="s3-2" class="score-label"><span class="score-number">2</span><span class="score-desc">éœ€å¤šç£ä¿ƒ</span></label></div>
                    <div class="score-option"><input type="radio" name="score3" id="s3-1" value="1"><label for="s3-1" class="score-label"><span class="score-number">1</span><span class="score-desc">ä¹ æƒ¯è¾ƒå·®</span></label></div>
                </div>
            </div>

            <div class="dimension-card">
                <div class="dimension-title">ğŸ’ª ç»´åº¦å››ï¼šå¿ƒç†ç´ è´¨</div>
                <div class="dimension-desc">æŠ—å‹èƒ½åŠ›å’Œå¿ƒç†æ‰¿å—èƒ½åŠ›</div>
                <div class="score-options">
                    <div class="score-option"><input type="radio" name="score4" id="s4-5" value="5"><label for="s4-5" class="score-label"><span class="score-number">5</span><span class="score-desc">æŠ—å‹å¾ˆå¼º</span></label></div>
                    <div class="score-option"><input type="radio" name="score4" id="s4-4" value="4"><label for="s4-4" class="score-label"><span class="score-number">4</span><span class="score-desc">å¿ƒæ€ç¨³å®š</span></label></div>
                    <div class="score-option"><input type="radio" name="score4" id="s4-3" value="3"><label for="s4-3" class="score-label"><span class="score-number">3</span><span class="score-desc">ä¸€èˆ¬æ°´å¹³</span></label></div>
                    <div class="score-option"><input type="radio" name="score4" id="s4-2" value="2"><label for="s4-2" class="score-label"><span class="score-number">2</span><span class="score-desc">å®¹æ˜“ç„¦è™‘</span></label></div>
                    <div class="score-option"><input type="radio" name="score4" id="s4-1" value="1"><label for="s4-1" class="score-label"><span class="score-number">1</span><span class="score-desc">éœ€è¦å…³æ³¨</span></label></div>
                </div>
            </div>

            <div class="dimension-card">
                <div class="dimension-title">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ ç»´åº¦äº”ï¼šå®¶åº­æ”¯æŒ</div>
                <div class="dimension-desc">å®¶åº­åœ¨æ—¶é—´ã€ç»æµã€ç²¾åŠ›æ–¹é¢çš„æ”¯æŒ</div>
                <div class="score-options">
                    <div class="score-option"><input type="radio" name="score5" id="s5-5" value="5"><label for="s5-5" class="score-label"><span class="score-number">5</span><span class="score-desc">å…¨åŠ›æ”¯æŒ</span></label></div>
                    <div class="score-option"><input type="radio" name="score5" id="s5-4" value="4"><label for="s5-4" class="score-label"><span class="score-number">4</span><span class="score-desc">ç§¯ææ”¯æŒ</span></label></div>
                    <div class="score-option"><input type="radio" name="score5" id="s5-3" value="3"><label for="s5-3" class="score-label"><span class="score-number">3</span><span class="score-desc">ä¸€èˆ¬æ”¯æŒ</span></label></div>
                    <div class="score-option"><input type="radio" name="score5" id="s5-2" value="2"><label for="s5-2" class="score-label"><span class="score-number">2</span><span class="score-desc">æœ‰é™æ”¯æŒ</span></label></div>
                    <div class="score-option"><input type="radio" name="score5" id="s5-1" value="1"><label for="s5-1" class="score-label"><span class="score-number">1</span><span class="score-desc">æ”¯æŒä¸è¶³</span></label></div>
                </div>
            </div>

            <div class="dimension-card">
                <div class="dimension-title">ğŸ”¬ ç»´åº¦å…­ï¼šå­¦ç§‘å€¾å‘</div>
                <div class="dimension-desc">å­©å­çš„å­¦ç§‘ä¼˜åŠ¿å’Œå…´è¶£æ–¹å‘</div>
                <div class="score-options">
                    <div class="score-option"><input type="radio" name="score6" id="s6-5" value="5"><label for="s6-5" class="score-label"><span class="score-number">5</span><span class="score-desc">ç†ç§‘ä¼˜åŠ¿</span></label></div>
                    <div class="score-option"><input type="radio" name="score6" id="s6-4" value="4"><label for="s6-4" class="score-label"><span class="score-number">4</span><span class="score-desc">æ–‡ç§‘ä¼˜åŠ¿</span></label></div>
                    <div class="score-option"><input type="radio" name="score6" id="s6-3" value="3"><label for="s6-3" class="score-label"><span class="score-number">3</span><span class="score-desc">å‡è¡¡å‘å±•</span></label></div>
                    <div class="score-option"><input type="radio" name="score6" id="s6-2" value="2"><label for="s6-2" class="score-label"><span class="score-number">2</span><span class="score-desc">æœ‰åç§‘</span></label></div>
                    <div class="score-option"><input type="radio" name="score6" id="s6-1" value="1"><label for="s6-1" class="score-label"><span class="score-number">1</span><span class="score-desc">å­¦ä¹ å›°éš¾</span></label></div>
                </div>
            </div>

            <div class="button-group">
                <button class="btn btn-secondary" onclick="goToStep1()">â† ä¸Šä¸€æ­¥</button>
                <button class="btn btn-primary" onclick="goToStep3()">ä¸‹ä¸€æ­¥ï¼šæˆ·ç±ä¸å±…ä½ä¿¡æ¯ â†’</button>
            </div>
        </div>

        <!-- æ­¥éª¤3ï¼šæˆ·ç±ä¸å±…ä½ä¿¡æ¯ -->
        <div id="step3" class="section">
            <div class="info-section">
                <h3>ğŸ  æˆ·ç±ä¸å±…ä½ä¿¡æ¯</h3>
                <p style="color: #718096; margin-bottom: 20px; font-size: 14px;">è¯·å‡†ç¡®å¡«å†™æˆ·ç±å’Œå®é™…å±…ä½ä¿¡æ¯ï¼Œè¿™å°†ç›´æ¥å½±å“å…¬åŠå­¦æ ¡åŒ¹é…å’Œå…¥å­¦é¡ºä½è¯„ä¼°</p>
                
                <div class="location-grid">
                    <!-- æˆ·ç±ä¿¡æ¯ -->
                    <div class="location-section">
                        <h4>ğŸ“ æˆ·ç±ä¿¡æ¯</h4>
                        <div class="info-group">
                            <label class="info-label">æˆ·ç±æ‰€åœ¨åŒº <span style="color: #e53e3e;">*</span></label>
                            <select class="info-select" id="householdDistrict">
                                <option value="">è¯·é€‰æ‹©åŒº</option>
                                <option value="æ–°åŸåŒº">æ–°åŸåŒº</option>
                                <option value="ç¢‘æ—åŒº">ç¢‘æ—åŒº</option>
                                <option value="è²æ¹–åŒº">è²æ¹–åŒº</option>
                                <option value="é›å¡”åŒº">é›å¡”åŒº</option>
                                <option value="çæ¡¥åŒº">çæ¡¥åŒº</option>
                                <option value="æœªå¤®åŒº">æœªå¤®åŒº</option>
                                <option value="é˜è‰¯åŒº">é˜è‰¯åŒº</option>
                                <option value="ä¸´æ½¼åŒº">ä¸´æ½¼åŒº</option>
                                <option value="é•¿å®‰åŒº">é•¿å®‰åŒº</option>
                                <option value="é«˜é™µåŒº">é«˜é™µåŒº</option>
                                <option value="é„ é‚‘åŒº">é„ é‚‘åŒº</option>
                                <option value="è“ç”°å¿">è“ç”°å¿</option>
                                <option value="å‘¨è‡³å¿">å‘¨è‡³å¿</option>
                                <option value="è¥¿å’¸æ–°åŒº">è¥¿å’¸æ–°åŒº</option>
                                <option value="é«˜æ–°åŒº">é«˜æ–°åŒº</option>
                                <option value="ç»å¼€åŒº">ç»å¼€åŒº</option>
                                <option value="æ›²æ±Ÿæ–°åŒº">æ›²æ±Ÿæ–°åŒº</option>
                                <option value="æµçå›½é™…æ¸¯ï¼ˆæµçç‰‡åŒºï¼‰">æµçå›½é™…æ¸¯ï¼ˆæµçç‰‡åŒºï¼‰</option>
                                <option value="æµçå›½é™…æ¸¯ï¼ˆæ¸¯åŠ¡ç‰‡åŒºï¼‰">æµçå›½é™…æ¸¯ï¼ˆæ¸¯åŠ¡ç‰‡åŒºï¼‰</option>
                                <option value="èˆªå¤©åŸºåœ°">èˆªå¤©åŸºåœ°</option>
                                <option value="å¤–åœ°æˆ·ç±">å¤–åœ°æˆ·ç±</option>
                            </select>
                        </div>
                        <div class="info-group">
                            <label class="info-label">æˆ·ç±æ‰€åœ¨è¡—é“</label>
                            <select class="info-select" id="householdStreet">
                                <option value="">è¯·å…ˆé€‰æ‹©åŒº</option>
                            </select>
                        </div>
                        <div class="info-group">
                            <label class="info-label">æˆ·ç±è¯¦ç»†åœ°å€ï¼ˆå¯é€‰ï¼‰</label>
                            <input type="text" class="info-input" id="householdAddress" placeholder="ä¾‹å¦‚ï¼šXXå°åŒºXXå·æ¥¼XXå•å…ƒ">
                        </div>
                    </div>
                    
                    <!-- å±…ä½ä¿¡æ¯ -->
                    <div class="location-section">
                        <h4>ğŸ¡ å®é™…å±…ä½ä¿¡æ¯</h4>
                        <div class="info-group">
                            <label class="info-label">å®é™…å±…ä½åŒº <span style="color: #e53e3e;">*</span></label>
                            <select class="info-select" id="residenceDistrict">
                                <option value="">è¯·é€‰æ‹©åŒº</option>
                                <option value="æ–°åŸåŒº">æ–°åŸåŒº</option>
                                <option value="ç¢‘æ—åŒº">ç¢‘æ—åŒº</option>
                                <option value="è²æ¹–åŒº">è²æ¹–åŒº</option>
                                <option value="é›å¡”åŒº">é›å¡”åŒº</option>
                                <option value="çæ¡¥åŒº">çæ¡¥åŒº</option>
                                <option value="æœªå¤®åŒº">æœªå¤®åŒº</option>
                                <option value="é˜è‰¯åŒº">é˜è‰¯åŒº</option>
                                <option value="ä¸´æ½¼åŒº">ä¸´æ½¼åŒº</option>
                                <option value="é•¿å®‰åŒº">é•¿å®‰åŒº</option>
                                <option value="é«˜é™µåŒº">é«˜é™µåŒº</option>
                                <option value="é„ é‚‘åŒº">é„ é‚‘åŒº</option>
                                <option value="è“ç”°å¿">è“ç”°å¿</option>
                                <option value="å‘¨è‡³å¿">å‘¨è‡³å¿</option>
                                <option value="è¥¿å’¸æ–°åŒº">è¥¿å’¸æ–°åŒº</option>
                                <option value="é«˜æ–°åŒº">é«˜æ–°åŒº</option>
                                <option value="ç»å¼€åŒº">ç»å¼€åŒº</option>
                                <option value="æ›²æ±Ÿæ–°åŒº">æ›²æ±Ÿæ–°åŒº</option>
                                <option value="æµçå›½é™…æ¸¯ï¼ˆæµçç‰‡åŒºï¼‰">æµçå›½é™…æ¸¯ï¼ˆæµçç‰‡åŒºï¼‰</option>
                                <option value="æµçå›½é™…æ¸¯ï¼ˆæ¸¯åŠ¡ç‰‡åŒºï¼‰">æµçå›½é™…æ¸¯ï¼ˆæ¸¯åŠ¡ç‰‡åŒºï¼‰</option>
                                <option value="èˆªå¤©åŸºåœ°">èˆªå¤©åŸºåœ°</option>
                            </select>
                        </div>
                        <div class="info-group">
                            <label class="info-label">å®é™…å±…ä½è¡—é“</label>
                            <select class="info-select" id="residenceStreet">
                                <option value="">è¯·å…ˆé€‰æ‹©åŒº</option>
                            </select>
                        </div>
                        <div class="info-group">
                            <label class="info-label">å±…ä½è¯¦ç»†åœ°å€</label>
                            <input type="text" class="info-input" id="residenceAddress" placeholder="ä¾‹å¦‚ï¼šXXå°åŒºXXå·æ¥¼XXå•å…ƒ">
                        </div>
                        <div class="info-group">
                            <label class="info-label">å±…ä½æ€§è´¨</label>
                            <select class="info-select" id="residenceType">
                                <option value="">è¯·é€‰æ‹©</option>
                                <option value="è‡ªæœ‰æˆ¿äº§">è‡ªæœ‰æˆ¿äº§</option>
                                <option value="ç§Ÿæˆ¿">ç§Ÿæˆ¿</option>
                                <option value="å•ä½å®¿èˆ">å•ä½å®¿èˆ</option>
                                <option value="å…¶ä»–">å…¶ä»–</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- å±…ä½åŒ¹é…æƒ…å†µ -->
                <div class="info-group">
                    <label class="info-label">æˆ·ç±ä¸å±…ä½åœ°åŒ¹é…æƒ…å†µ</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label"><input type="checkbox" id="sameDistrict"> æˆ·ç±åŒºä¸å±…ä½åŒºç›¸åŒ</label>
                        <label class="checkbox-label"><input type="checkbox" id="sameStreet"> æˆ·ç±è¡—é“ä¸å±…ä½è¡—é“ç›¸åŒ</label>
                        <label class="checkbox-label"><input type="checkbox" id="inSchoolDistrict"> åœ¨å­¦åŒºå†…å±…ä½</label>
                    </div>
                </div>
                
                <div class="transport-info">
                    <h5>ğŸš— äº¤é€šä¾¿åˆ©æ€§è¯„ä¼°</h5>
                    <p style="font-size: 13px; color: #4a5568;">ç³»ç»Ÿå°†æ ¹æ®æ‚¨çš„å±…ä½ä½ç½®è¯„ä¼°åˆ°æ¨èå­¦æ ¡çš„é€šå‹¤æ—¶é—´ï¼Œä¼˜å…ˆæ¨èäº¤é€šä¾¿åˆ©çš„å­¦æ ¡</p>
                </div>
            </div>
            
            <div class="button-group">
                <button class="btn btn-secondary" onclick="goToStep2()">â† ä¸Šä¸€æ­¥</button>
                <button class="btn btn-primary" onclick="if(validateStep3()) goToStep4()">ä¸‹ä¸€æ­¥ï¼šå­¦åŒºæˆ¿äº§ä¿¡æ¯ â†’</button>
            </div>
        </div>

        <!-- æ­¥éª¤4ï¼šå­¦åŒºæˆ¿äº§ä¿¡æ¯ -->
        <div id="step4" class="section">
            <div class="info-section">
                <h3>ğŸ“‹ å­¦åŒºæˆ¿äº§ä¿¡æ¯</h3>
                <p style="color: #718096; margin-bottom: 20px; font-size: 14px;">å…¬åŠå­¦æ ¡å…¥å­¦èµ„æ ¼ç›¸å…³ä¿¡æ¯ï¼Œè¯·å¦‚å®å¡«å†™</p>
                
                <div class="info-group">
                    <label class="info-label">å­¦åŒºæˆ¿æƒ…å†µ</label>
                    <select class="info-select" id="hasHouse">
                        <option value="">è¯·é€‰æ‹©</option>
                        <option value="yes-good">æœ‰ï¼Œå¯¹å£ä¼˜è´¨å…¬åŠ</option>
                        <option value="yes-normal">æœ‰ï¼Œå¯¹å£ä¸€èˆ¬å…¬åŠ</option>
                        <option value="no">æš‚æ— å­¦åŒºæˆ¿</option>
                        <option value="rent">ç§Ÿæˆ¿å±…ä½</option>
                    </select>
                </div>
                
                <div class="info-group">
                    <label class="info-label">æˆ¿äº§è¯ç±»å‹</label>
                    <select class="info-select" id="propertyType">
                        <option value="">è¯·é€‰æ‹©</option>
                        <option value="å•†å“æˆ¿">å•†å“æˆ¿</option>
                        <option value="æˆ¿æ”¹æˆ¿">æˆ¿æ”¹æˆ¿</option>
                        <option value="å®‰ç½®æˆ¿">å®‰ç½®æˆ¿</option>
                        <option value="ç»æµé€‚ç”¨æˆ¿">ç»æµé€‚ç”¨æˆ¿</option>
                        <option value="å…¶ä»–">å…¶ä»–</option>
                    </select>
                </div>
                
                <div class="info-group">
                    <label class="info-label">æˆ¿äº§æŒæœ‰æ—¶é—´</label>
                    <select class="info-select" id="propertyYears">
                        <option value="">è¯·é€‰æ‹©</option>
                        <option value="3å¹´ä»¥ä¸Š">3å¹´ä»¥ä¸Š</option>
                        <option value="1-3å¹´">1-3å¹´</option>
                        <option value="1å¹´ä»¥å†…">1å¹´ä»¥å†…</option>
                        <option value="æ–°è´­">æ–°è´­ï¼ˆæœªæ»¡1å¹´ï¼‰</option>
                    </select>
                </div>
                
                <div class="info-group">
                    <label class="info-label">é¢„ä¼°å…¥å­¦é¡ºä½</label>
                    <div style="background: #f0fff4; padding: 15px; border-radius: 8px; border: 1px solid #c6f6d5;">
                        <div id="admissionPriority" style="color: #276749; font-weight: 600;">è¯·å¡«å†™ä»¥ä¸Šä¿¡æ¯åè‡ªåŠ¨è¯„ä¼°</div>
                        <div id="priorityReason" style="color: #718096; font-size: 13px; margin-top: 5px;">åŸºäºè¥¿å®‰å¸‚å…¬åŠå…¥å­¦æ”¿ç­–è¯„ä¼°</div>
                    </div>
                    <button class="btn-ai-interpret" onclick="interpretPolicy()" id="interpretBtn" style="margin-top: 10px; width:100%;"><i class="fas fa-brain"></i> AIä¸ºä½ è§£è¯»é¡ºä½</button>
                    <div id="interpretationResult" class="ai-interpretation-box"></div>

                </div>
                
                <div class="policy-box">
                    <h4>ğŸ“ è¥¿å®‰å¸‚å…¬åŠå…¥å­¦é¡ºä½è¯´æ˜</h4>
                    <p><strong>ç¬¬ä¸€é¡ºä½ï¼š</strong>æˆ¿æˆ·ä¸€è‡´ï¼Œä¸”åœ¨å­¦åŒºå†…å±…ä½</p>
                    <p><strong>ç¬¬äºŒé¡ºä½ï¼š</strong>æˆ¿æˆ·ä¸€è‡´ï¼Œä½†è·¨å­¦åŒºå±…ä½</p>
                    <p><strong>ç¬¬ä¸‰é¡ºä½ï¼š</strong>é›†ä½“æˆ·/æŒ‚é æˆ·ï¼Œæ— å­¦åŒºæˆ¿</p>
                    <p><strong>ç¬¬å››é¡ºä½ï¼š</strong>ç§Ÿæˆ¿å±…ä½ï¼Œç»Ÿç­¹å®‰æ’å…¥å­¦</p>
                </div>
            </div>
            
            <div class="button-group">
                <button class="btn btn-secondary" onclick="goToStep3()">â† ä¸Šä¸€æ­¥</button>
                <button class="btn btn-primary" onclick="goToStep5()">ä¸‹ä¸€æ­¥ï¼šæ°‘åŠæ„å‘ä¸é¢„ç®— â†’</button>
            </div>
        </div>

        <!-- æ­¥éª¤5ï¼šæ°‘åŠæ„å‘ä¸é¢„ç®— -->
        <div id="step5" class="section">
            <div class="info-section">
                <h3>ğŸ’° æ°‘åŠæ„å‘ä¸é¢„ç®—</h3>
                
                <div class="info-group">
                    <label class="info-label">æ˜¯å¦è€ƒè™‘æ°‘åŠå­¦æ ¡</label>
                    <select class="info-select" id="considerPrivate">
                        <option value="">è¯·é€‰æ‹©</option>
                        <option value="yes">æ˜¯ï¼Œæ„¿æ„å‚åŠ æ‘‡å·</option>
                        <option value="cautious">è§‚æœ›ä¸­ï¼Œçœ‹æƒ…å†µå†³å®š</option>
                        <option value="no">å¦ï¼Œåªè€ƒè™‘å…¬åŠ</option>
                    </select>
                </div>
                
                <div class="info-group">
                    <label class="info-label">å¯æ¥å—çš„è·¨åŒºèŒƒå›´</label>
                    <select class="info-select" id="crossDistrictPreference">
                        <option value="">è¯·é€‰æ‹©</option>
                        <option value="æœ¬åŒº">ä»…é™æœ¬åŒºå­¦æ ¡</option>
                        <option value="ç›¸é‚»åŒº">æœ¬åŒºåŠç›¸é‚»åŒº</option>
                        <option value="å…¨å¸‚èŒƒå›´">å…¨å¸‚èŒƒå›´å‡å¯</option>
                    </select>
                </div>
                
                <div class="info-group">
                    <label class="info-label">æ°‘åŠå­¦æ ¡é¢„ç®—ï¼ˆåˆä¸­ä¸‰å¹´ï¼‰</label>
                    <select class="info-select" id="budget">
                        <option value="">è¯·é€‰æ‹©</option>
                        <option value="low">3ä¸‡ä»¥å†…ï¼ˆå…¬åŠä¸ºä¸»ï¼‰</option>
                        <option value="medium">3-10ä¸‡ï¼ˆå¯è€ƒè™‘æ°‘åŠï¼‰</option>
                        <option value="high">10ä¸‡ä»¥ä¸Šï¼ˆæ°‘åŠæ— å‹åŠ›ï¼‰</option>
                    </select>
                </div>
                
                <div class="info-group">
                    <label class="info-label">å¯¹æ‘‡å·ä¸ç¡®å®šæ€§çš„æ€åº¦</label>
                    <select class="info-select" id="acceptLottery">
                        <option value="">è¯·é€‰æ‹©</option>
                        <option value="yes">æ¥å—ï¼Œæ„¿æ„å†²åˆºçƒ­é—¨æ ¡</option>
                        <option value="cautious">è°¨æ…ï¼Œå¸Œæœ›ç¨³å¦¥ä¸ºä¸»</option>
                        <option value="no">ä¸æ¥å—ï¼Œå¿…é¡»ç¡®å®šæ€§</option>
                    </select>
                </div>
                
                <div class="info-group">
                    <label class="info-label">å­©å­ç‰¹é•¿ï¼ˆå¯å¤šé€‰ï¼‰</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label"><input type="checkbox" value="æ•°å­¦" name="specialty" class="strength-check"> æ•°å­¦</label>
                        <label class="checkbox-label"><input type="checkbox" value="è¯­æ–‡" name="specialty" class="strength-check"> è¯­æ–‡</label>
                        <label class="checkbox-label"><input type="checkbox" value="è‹±è¯­" name="specialty" class="strength-check"> è‹±è¯­</label>
                        <label class="checkbox-label"><input type="checkbox" value="è‰ºæœ¯" name="specialty" class="strength-check"> è‰ºæœ¯</label>
                        <label class="checkbox-label"><input type="checkbox" value="ä½“è‚²" name="specialty" class="strength-check"> ä½“è‚²</label>
                        <label class="checkbox-label"><input type="checkbox" value="ç§‘æŠ€" name="specialty" class="strength-check"> ç§‘æŠ€</label>
                    </div>
                </div>
            </div>
            
            <div class="button-group">
                <button class="btn btn-secondary" onclick="goToStep4()">â† ä¸Šä¸€æ­¥</button>
                <button class="btn btn-primary" onclick="goToStep6()">ä¸‹ä¸€æ­¥ï¼šèƒ½åŠ›åˆ†æ â†’</button>
            </div>
        </div>

        <!-- æ­¥éª¤6ï¼šèƒ½åŠ›åˆ†æï¼ˆæ–°å¢é¡µé¢ï¼‰ -->
        <div id="step6" class="section">
            <div class="result-card">
                <div class="result-title">ğŸ“Š å­¦ç”Ÿèƒ½åŠ›é›·è¾¾å›¾</div>
                <div class="chart-container" style="width: 90%; max-width: 600px; margin: 20px auto; background: #fff; padding: 25px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.08);">
                    <canvas id="abilityChart" width="400" height="300"></canvas>
                    <div id="abilityAnalysis" class="ai-interpretation-box" style="text-align: left; margin-top: 30px;"></div>
                </div>
            </div>
            
            <div class="button-group">
                <button class="btn btn-secondary" onclick="goToStep5()">â† ä¸Šä¸€æ­¥</button>
                <button class="btn btn-primary" onclick="generateReport()">ç”Ÿæˆå®Œæ•´æŠ¥å‘Š â†’</button>
            </div>
        </div>

        <!-- æ­¥éª¤7ï¼šAIæ¨èï¼ˆåŸæ­¥éª¤6ï¼‰ -->
        <div id="step7" class="section">
            <div id="familyProfile" class="family-profile-card"></div>

            <div class="result-card">
                <div class="result-title">ğŸ« AIæ™ºèƒ½å­¦æ ¡æ¨è</div>
                <div id="schoolRecommendation">
                    <div class="ai-loading">
                        <div class="ai-loading-spinner"></div>
                        <p>AIæ­£åœ¨åŸºäºæ‚¨çš„ä¿¡æ¯è¿›è¡Œæ·±åº¦åˆ†æ...</p>
                        <div class="source-info">
                            <span class="trust-badge trust-verified">å¤šé‡éªŒè¯ä¸­</span>
                            æ­£åœ¨éªŒè¯ä¿¡æ¯å‡†ç¡®æ€§å’Œæ—¶æ•ˆæ€§
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="result-card">
                <div class="result-title">ğŸ“… ä¸ªæ€§åŒ–æ—¶é—´è§„åˆ’</div>
                <div id="timeline"></div>
            </div>
            
            <div class="result-card">
                <div class="result-title">ğŸ’¡ æ”¿ç­–æé†’ä¸å»ºè®®</div>
                <div id="policyAdvice"></div>
            </div>
            
            <div class="button-group">
                <button class="btn btn-secondary" onclick="goToStep6()">â† è¿”å›ä¿®æ”¹</button>
                <button class="btn btn-primary" onclick="printOptimizedReport()">
                    <i class="fas fa-print"></i> æ‰“å°ä¸“ä¸šæŠ¥å‘Š
                </button>
                <button class="btn btn-secondary" onclick="exportReportPDF()">
                    <i class="fas fa-file-pdf"></i> å¯¼å‡ºPDF
                </button>
                <button class="btn btn-secondary" onclick="exportReportJSON()">
                    <i class="fas fa-file-code"></i> å¯¼å‡ºJSON
                </button>
                <button class="btn btn-secondary" onclick="resetAll()">
                    <i class="fas fa-redo"></i> é‡æ–°è¯„ä¼°
                </button>    
            </div>
        </div>
    </div>

    <!-- å¤–éƒ¨JS -->
    <script src="script.js"></script>
    
    <!-- ä¿®å¤çš„èŠå¤©å’Œæ­¥éª¤å¯¼èˆªåŠŸèƒ½ -->
    <script>
    // ========== ä¿®å¤æ­¥éª¤å¯¼èˆªå‡½æ•° ==========
    window.showStep = function(stepNumber) {
        // ç¡®ä¿æ­¥éª¤ç¼–å·åœ¨æœ‰æ•ˆèŒƒå›´å†…
        if (stepNumber < 1 || stepNumber > 7) return;
        
        // éšè—æ‰€æœ‰æ­¥éª¤
        document.querySelectorAll('.section').forEach(section => {
            section.classList.remove('active');
        });
        
        // æ˜¾ç¤ºç›®æ ‡æ­¥éª¤
        const targetSection = document.getElementById(`step${stepNumber}`);
        if (targetSection) {
            targetSection.classList.add('active');
        }
        
        // æ›´æ–°æ­¥éª¤æŒ‡ç¤ºå™¨
        document.querySelectorAll('.step').forEach(step => {
            step.classList.remove('active');
        });
        
        const targetIndicator = document.getElementById(`step${stepNumber}-indicator`);
        if (targetIndicator) {
            targetIndicator.classList.add('active');
        }
        
        // æ›´æ–°è¿›åº¦æ¡
        const progressBar = document.getElementById('progressBar');
        if (progressBar) {
            const progress = ((stepNumber - 1) / 6) * 100;
            progressBar.style.width = `${progress}%`;
        }
        
        // æ»šåŠ¨åˆ°é¡¶éƒ¨
        window.scrollTo({ top: 0, behavior: 'smooth' });
    };

    // æ­¥éª¤å¯¼èˆªå¿«æ·å‡½æ•°
    window.goToStep1 = () => window.showStep(1);
    window.goToStep2 = () => window.showStep(2);
    window.goToStep3 = () => window.showStep(3);
    window.goToStep4 = () => window.showStep(4);
    window.goToStep5 = () => window.showStep(5);
    window.goToStep6 = () => window.showStep(6);
    window.goToStep7 = () => window.showStep(7);

    // ========== ä¿®å¤èŠå¤©çª—å£æ‹–åŠ¨åŠŸèƒ½ ==========
    let isDragging = false;
    let dragOffsetX = 0;
    let dragOffsetY = 0;
    let currentChatWindow = null;

    document.addEventListener('DOMContentLoaded', function() {
        // è·å–èŠå¤©çª—å£å’Œå¤´éƒ¨
        const chatWindow = document.getElementById('chatWindow');
        const chatHeader = document.getElementById('chatHeader');
        
        if (!chatWindow || !chatHeader) return;
        
        // åˆ›å»ºå…³é—­æŒ‰é’®
        const closeBtn = document.createElement('button');
        closeBtn.className = 'chat-close-btn';
        closeBtn.innerHTML = '<i class="fas fa-times"></i>';
        closeBtn.onclick = function(e) {
            e.stopPropagation();
            chatWindow.classList.remove('active');
        };
        
        chatHeader.appendChild(closeBtn);
        
        // é¼ æ ‡æŒ‰ä¸‹äº‹ä»¶ - å¼€å§‹æ‹–åŠ¨
        chatHeader.addEventListener('mousedown', function(e) {
            // å¦‚æœç‚¹å‡»çš„æ˜¯å…³é—­æŒ‰é’®ï¼Œä¸è§¦å‘æ‹–åŠ¨
            if (e.target.closest('.chat-close-btn')) return;
            
            isDragging = true;
            currentChatWindow = chatWindow;
            
            // è®¡ç®—åç§»é‡
            const rect = chatWindow.getBoundingClientRect();
            dragOffsetX = e.clientX - rect.left;
            dragOffsetY = e.clientY - rect.top;
            
            // æ·»åŠ æ‹–åŠ¨æ ·å¼
            chatWindow.classList.add('dragging');
            
            e.preventDefault();
        });
        
        // é¼ æ ‡ç§»åŠ¨äº‹ä»¶ - æ‹–åŠ¨ä¸­
        document.addEventListener('mousemove', function(e) {
            if (!isDragging || !currentChatWindow) return;
            
            // è®¡ç®—æ–°ä½ç½®
            let newX = e.clientX - dragOffsetX;
            let newY = e.clientY - dragOffsetY;
            
            // é™åˆ¶åœ¨çª—å£èŒƒå›´å†…
            const maxX = window.innerWidth - currentChatWindow.offsetWidth;
            const maxY = window.innerHeight - currentChatWindow.offsetHeight;
            
            newX = Math.max(0, Math.min(newX, maxX));
            newY = Math.max(0, Math.min(newY, maxY));
            
            // åº”ç”¨æ–°ä½ç½®
            currentChatWindow.style.left = newX + 'px';
            currentChatWindow.style.right = 'auto';
            currentChatWindow.style.top = newY + 'px';
            currentChatWindow.style.bottom = 'auto';
        });
        
        // é¼ æ ‡æ¾å¼€äº‹ä»¶ - åœæ­¢æ‹–åŠ¨
        document.addEventListener('mouseup', function() {
            if (isDragging && currentChatWindow) {
                isDragging = false;
                currentChatWindow.classList.remove('dragging');
                currentChatWindow = null;
            }
        });
        
        // è§¦æ‘¸äº‹ä»¶æ”¯æŒï¼ˆç§»åŠ¨ç«¯ï¼‰
        chatHeader.addEventListener('touchstart', function(e) {
            if (e.target.closest('.chat-close-btn')) return;
            
            isDragging = true;
            currentChatWindow = chatWindow;
            
            const touch = e.touches[0];
            const rect = chatWindow.getBoundingClientRect();
            dragOffsetX = touch.clientX - rect.left;
            dragOffsetY = touch.clientY - rect.top;
            
            chatWindow.classList.add('dragging');
            e.preventDefault();
        });
        
        document.addEventListener('touchmove', function(e) {
            if (!isDragging || !currentChatWindow) return;
            
            const touch = e.touches[0];
            let newX = touch.clientX - dragOffsetX;
            let newY = touch.clientY - dragOffsetY;
            
            const maxX = window.innerWidth - currentChatWindow.offsetWidth;
            const maxY = window.innerHeight - currentChatWindow.offsetHeight;
            
            newX = Math.max(0, Math.min(newX, maxX));
            newY = Math.max(0, Math.min(newY, maxY));
            
            currentChatWindow.style.left = newX + 'px';
            currentChatWindow.style.right = 'auto';
            currentChatWindow.style.top = newY + 'px';
            currentChatWindow.style.bottom = 'auto';
            
            e.preventDefault();
        });
        
        document.addEventListener('touchend', function() {
            if (isDragging && currentChatWindow) {
                isDragging = false;
                currentChatWindow.classList.remove('dragging');
                currentChatWindow = null;
            }
        });
    });

    // ========== ä¿®å¤èŠå¤©è¾“å…¥æ¡†è‡ªåŠ¨é«˜åº¦ ==========
    function adjustChatInputHeight() {
        const chatInput = document.getElementById('chatInput');
        if (!chatInput) return;
        
        // é‡ç½®é«˜åº¦
        chatInput.style.height = 'auto';
        
        // è®¾ç½®æ–°é«˜åº¦ï¼Œæœ€å¤§120px
        const newHeight = Math.min(chatInput.scrollHeight, 120);
        chatInput.style.height = newHeight + 'px';
    }

    // ========== ä¿®å¤å‘é€æ¶ˆæ¯å‡½æ•° ==========
    window.sendMessage = function() {
        const chatInput = document.getElementById('chatInput');
        if (!chatInput) return;
        
        const message = chatInput.value.trim();
        if (!message) return;
        
        // æ˜¾ç¤ºç”¨æˆ·æ¶ˆæ¯
        addMessageToChat('user', message);
        
        // æ¸…ç©ºè¾“å…¥æ¡†
        chatInput.value = '';
        adjustChatInputHeight();
        
        // æ˜¾ç¤ºAIå›å¤ï¼ˆæ¨¡æ‹Ÿï¼‰
        setTimeout(() => {
            const responses = [
                "æ‚¨å¥½ï¼æˆ‘æ˜¯å°å–µå‡å­¦åŠ©æ‰‹ï¼Œå¾ˆé«˜å…´ä¸ºæ‚¨æœåŠ¡ï¼",
                "å…³äº2025å¹´è¥¿å®‰å°å‡åˆæ”¿ç­–ï¼Œä¸»è¦ç‰¹ç‚¹æ˜¯å…¬æ°‘åŒæ‹›ã€å…è¯•å…¥å­¦ã€æ°‘åŠæ‘‡å·ã€‚",
                "å»ºè®®æ‚¨å…ˆå¡«å†™å®Œæ•´çš„åŸºç¡€ä¿¡æ¯ï¼Œç³»ç»Ÿå¯ä»¥ä¸ºæ‚¨æä¾›æ›´ç²¾å‡†çš„å­¦æ ¡æ¨èã€‚",
                "è¥¿å®‰å¸‚2025å¹´æ°‘åŠåˆä¸­æ‹›ç”Ÿè®¡åˆ’ä¸º12361äººï¼ŒæŠ¥åæ—¶é—´ä¸º7æœˆ11-24æ—¥ã€‚",
                "å…¬åŠå­¦æ ¡æŒ‰ç…§å­¦åŒºåˆ’ç‰‡æ‹›ç”Ÿï¼Œéœ€è¦ç¡®è®¤æ‚¨çš„æˆ·ç±å’Œå±…ä½åœ°ä¿¡æ¯ã€‚"
            ];
            
            const randomResponse = responses[Math.floor(Math.random() * responses.length)];
            addMessageToChat('assistant', randomResponse);
        }, 1000);
    };

    // ========== ä¿®å¤é”®ç›˜äº‹ä»¶å¤„ç† ==========
    window.handleChatKeyPress = function(event) {
        // Enterå‘é€ï¼ŒShift+Enteræ¢è¡Œ
        if (event.key === 'Enter' && !event.shiftKey) {
            event.preventDefault();
            sendMessage();
            return false;
        }
        
        // è‡ªåŠ¨è°ƒæ•´é«˜åº¦
        adjustChatInputHeight();
        return true;
    };

    // ========== èŠå¤©æ¶ˆæ¯æ·»åŠ åˆ°çª—å£ ==========
    function addMessageToChat(sender, content) {
        const chatBody = document.getElementById('chatBody');
        if (!chatBody) return;
        
        const messageDiv = document.createElement('div');
        messageDiv.className = `ai-message ${sender}`;
        
        const avatar = sender === 'user' ? 'ğŸ‘¤' : 'ğŸ±';
        messageDiv.innerHTML = `
            <div class="message-avatar">${avatar}</div>
            <div class="message-content">${content}</div>
        `;
        
        chatBody.appendChild(messageDiv);
        chatBody.scrollTop = chatBody.scrollHeight;
    }

    // ========== å¿«æ·æ“ä½œ ==========
    window.quickAction = function(action) {
        const chatInput = document.getElementById('chatInput');
        if (chatInput) {
            chatInput.value = action;
            // è§¦å‘å‘é€
            setTimeout(() => {
                sendMessage();
            }, 100);
        }
    };

    // ========== é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ– ==========
    document.addEventListener('DOMContentLoaded', function() {
        console.log('é¡µé¢åŠ è½½å®Œæˆï¼Œåˆå§‹åŒ–èŠå¤©åŠŸèƒ½...');
        
        // ç»‘å®šè¾“å…¥æ¡†äº‹ä»¶
        const chatInput = document.getElementById('chatInput');
        if (chatInput) {
            chatInput.addEventListener('input', adjustChatInputHeight);
            chatInput.addEventListener('keydown', handleChatKeyPress);
        }
        
        // ç»‘å®šå‘é€æŒ‰é’®
        const sendBtn = document.getElementById('sendBtn');
        if (sendBtn) {
            sendBtn.addEventListener('click', sendMessage);
        }
        
        // ç»‘å®šå¿«æ·æ“ä½œæŒ‰é’®
        document.querySelectorAll('.quick-action-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const action = this.textContent || this.getAttribute('onclick').match(/'([^']+)'/)[1];
                quickAction(action);
            });
        });
        
        console.log('èŠå¤©åŠŸèƒ½åˆå§‹åŒ–å®Œæˆï¼');
    });

    // ========== å…¶ä»–å…¨å±€å‡½æ•° ==========
    window.toggleChat = function() {
        const chatWindow = document.getElementById('chatWindow');
        if (chatWindow) {
            chatWindow.classList.toggle('active');
            // å¦‚æœçª—å£æ˜¾ç¤ºï¼Œèšç„¦åˆ°è¾“å…¥æ¡†
            if (chatWindow.classList.contains('active')) {
                setTimeout(() => {
                    const chatInput = document.getElementById('chatInput');
                    if (chatInput) chatInput.focus();
                }, 100);
            }
        }
    };

    window.toggleConfigPanel = function() {
        const configPanel = document.getElementById('configPanel');
        if (configPanel) {
            configPanel.classList.toggle('active');
        }
    };

    window.useLocalMode = function() {
        console.log('åˆ‡æ¢åˆ°æœ¬åœ°æ¨¡å¼');
        
        const statusText = document.getElementById('statusText');
        const apiStatus = document.getElementById('apiStatus');
        const chatApiStatus = document.getElementById('chatApiStatus');
        
        if (statusText) statusText.textContent = 'æœ¬åœ°æ¨¡å¼';
        if (apiStatus) {
            apiStatus.className = 'api-status local';
            apiStatus.textContent = 'æœ¬åœ°æ¨¡å¼';
        }
        if (chatApiStatus) chatApiStatus.textContent = 'æœ¬åœ°æ¨¡å¼';

        const configPanel = document.getElementById('configPanel');
        if (configPanel) {
            configPanel.classList.remove('active');
        }
        
        localStorage.setItem('aiMode', 'local');
        alert('å·²åˆ‡æ¢åˆ°æœ¬åœ°æ¨¡å¼ã€‚AIç›¸å…³åŠŸèƒ½å°†ä¸å¯ç”¨ã€‚');
    };

    // æ­¥éª¤3éªŒè¯å‡½æ•°
    function validateStep3() {
        const hukouDistrict = document.getElementById('householdDistrict');
        const residenceDistrict = document.getElementById('residenceDistrict');
        
        if (!hukouDistrict.value) {
            alert('è¯·é€‰æ‹©æˆ·ç±æ‰€åœ¨åŒº');
            hukouDistrict.focus();
            return false;
        }
        
        if (!residenceDistrict.value) {
            alert('è¯·é€‰æ‹©å®é™…å±…ä½åŒº');
            residenceDistrict.focus();
            return false;
        }
        
        return true;
    }

    // å°†å‡½æ•°æš´éœ²åˆ°å…¨å±€
    window.addMessageToChat = addMessageToChat;
    window.validateStep3 = validateStep3;
    </script>
</body>
</html>
